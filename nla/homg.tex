% nladoc.tex V2.0, 13 May 2010

\documentclass[times]{nlaauth}

\usepackage{moreverb}

\usepackage[colorlinks,bookmarksopen,bookmarksnumbered,citecolor=red,urlcolor=red]{hyperref}
\newcommand{\gsnote}[1]{\textcolor{blue}{GS: #1}}


\newcommand\BibTeX{{\rmfamily B\kern-.05em \textsc{i\kern-.025em b}\kern-.08em
T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\def\volumeyear{2013}

\begin{document}

\runningheads{Sundar~et~al.}{High-order Geometric Multigrid}

\title{On Geometric Multigrid Algorithms for High-order Finite Element Discretizations}

\author{Hari Sundar\corrauth, Georg Stadler, Omar Ghattas and George Biros}

\address{Institute for Computational Engineering \& Sciences, University of Texas, Austin, TX 78712}

\corraddr{\texttt{hari@ices.utexas.edu}}

\begin{abstract}
\input {homg_abstract.tex}
\end{abstract}

\keywords{geometric multigrid, high-order discretizations, p-multigrid}

\maketitle


\section{Introduction}

%We are interested on asymptotically
%optimal---$\mathcal{O}(N)$---complexity solvers for approximating the
%solution of elliptic partial differential equations (PDEs), where $N$
%is the number of unknowns.  Multigrid is such a solver. In practice
%however, multigrid performs best for low-order uniform discretizations
%with smooth coefficients. 

\gsnote{Unify notion of mesh/grid etc}

Our goal is to develop a parallel geometric multigrid for solving
systems arising from higher-order discretizations of
variable-coefficient elliptic partial differential equations on
arbitrary geometries using highly adapted meshes.
High-order discretizations offer several advantages.  According to
standard isoparametric polynomial approximation theory,
% the approximation error in the $L_2$-norm is bounded by,
% \[
% \|u-u_h\|_{L_2} \le Ch^{p+1}\|u\|_{H^{p+1}(\Omega)},
% \]   
% where $\|\cdot\|_{H^p}$ is the standard $H^p$ Sobolev norm, $\|\cdot\|_{L_2}$ is the $L_2$-norm, $u$ is the exact solution of the PDE, and $u_h$ is the solution of the $h$-discrete problem. Therefore, 
by using a finite element basis of at least degree $p$, we can achieve
very fast $\mathcal{O}(N^{-(p+1)})$ convergence for sufficiently
smooth problems while improving the locality and thus the CPU
efficiency of the calculations.

Our method is designed for meshes that are built from an unstructured
hexahedral macro mesh, in which each macro element is adaptively
refined as an octree. This forest-of-octrees approach enables us to
generate meshes for complex geometries with arbitrary levels of local
refinement. We use geometric multigrid (GMG) for each of the octrees
and algebraic multigrid (AMG) as the coarse grid solver. We designed
our GMG sweeps to entirely avoid collectives, thus minimizing
communication cost. Recently \cite{sundar12}, we presented weak and strong scaling
results for the 3D variable-coefficient Poisson problem using linear
discretization that demonstrate high parallel scalability. Here we
explore various approaches for extending our geometric multigrid
solver to support higher-order discretizations.


In summary, the overall theme of existing work appears to use
low-order approximations as preconditioners.  The advantages of doing
this are mainly in the simplicity of the approach and the availability
of parallel multigrid solvers capable of solving such lower-order
operators. The sparsity of the lower-order operators also permits the
use of AMG for solving the lower-order operators, possibly obtained
via discretizations on unstructured meshes.  Although there are
examples of using Algebraic Multigrid directly on operators resulting
from higher-order discretizations, limited work has been done on using
geometric multigrid with higher-order discretizations. To the best of
our knowledge, no prior work on using geometric multigrid for solving
systems arising from higher-order discretizations on arbitrary
geometries using highly adapted meshes.  In this work, we develop
geometric multigrid methods to support higher-order discretizations
($1\le p\le 8$) and compare compare against preconditioning using the
co-located linear operator. We evaluate using variable-coefficient
Poisson problems on $2D$ and $3D$ domains. We demonstrate that by
using appropriate inter-grid transfer operators and smoothers,
mesh-independent convergence is possible ($1\le p\le8$) for the {\em
direct} approach. For the direct approach, best results are obtained
using the symmetric successive over-relaxation (SSOR) smoother. We
conclude with thoughts on the parallelization of the proposed
approach.\\[2ex]



{\bf Targets:} We target multigrid for large-scale problems using
adaptively refined meshes on complex geometries, and their
implementation on parallel high performance computing platforms. Thus,
we are interested in
\begin{itemize}
\item matrix-free methods, i.e., method that do not require assembled
  finite element matrices,
\item methods that can be parallelized using shared or distributed
  memory and that can make efficient use of current multicore
  architectures
\item cache-efficient methods that access memory hierarchies locally
\end{itemize}


\section{Meshing, High-order FEM}

% high order is often good, but comes with problems

High order spatial discretizations can have significant advantages
over low order methods, especially when the solution is smooth and
high accuracy is desired. However, the sparsity of finite element (or
finite difference) operators decreases as the polynomial approximation
order increases, which makes the application of high order operators
to vectors computationally significantly more expensive. This is also
true if matrix-free methods are used, i.e., system matrices are never
assembled, but their application on vectors is implemented through
elemental loops.  Besides the loss of sparsity, another challenge in
high-order discretizations is due to that fact that the discretization
matrices loose useful structural properties, such as the M-matrix
property that allows to prove convergence of iterative solvers such as
the Jacobi or Gauss-Seidel.

For three-dimensional hexahedral mesh finite element discretizations
with polynomial degree $p$, element matrices are of size
$n=(p+1)^3$. The naive assembly and application of these elemental
matrices requires $\mathcal O(p^9)$ operatrions, but exploiting the
tensor structure of the basis functions allows to reduce this to
$\mathcal O(p^7)$ operations.




\section{Approaches for High-order Multigrid}

% talk about the 4 main approaches and prior work.

In this section, we summarize different approaches for geometric
multigrid based solvers and preconditioners in the case of
higher-order finite-element discretizations.

\subsection{High-order $h$-multigrid}
A direct generalization of geometric multigrid from first order to
higher order discretizations is to use high-order restriction and
prolongation operators together with the linear systems that result
from the higher-order discretizations on each coarse level.  One
difficulty in this approach is that it requires smoothers for high
order systems matrices, which usually have less favorable properties
compared to their low order counterparts; For instance, higher-order
discretizations of scalar elliptic operators are usually not
M-matrices---a useful property to prove the convergence of the Jacobi
and the Gauss-Seidel smoother.

% This
%approach is more difficult to implement and the cost per iteration
%increases. However, our preliminary results suggest that such an
%approach is the most general.

\subsection{$p$-multigrid}
These methods do not coarsen the grid geometrically, but coarsen the
system by reducing the polynomial order. Starting from a fine grid
with order-$p$ polynomial basis, the coarser grids correspond to
polynomials of order $p/2, p/4,\ldots,1$, followed by geometric
coarsening of the $p=1$ grid. Coarsening the polynomial order is
rather simple and element-local. The latter is particularly useful for
discretizations with nonconforming meshes. \gsnote{Is that actually
  true?}  The main shortcomings of this approach has been the
dependence of the convergence factor on the order of the polynomial
basis. \textsc{Revisit. any other disadvantages}?


\subsection{Preconditioning by lower-order operator}
This approach preconditions the higher-order operator using a
lower-order operator obtained by overlaying the higher-order nodes
with a lower-order (typically linear) finite element mesh using the
same same nodes.  Multigrid is used to solve the lower-order operator,
which has more favorable sparsity properties and thus allows for
faster multigrid cycles compared to multigrid for the high order
discretized systems.  Although this approach is nearly independent of
$p$, and is relatively straightforward to parallelize, it is not work
optimal and the convergence factors are lower than multigrid applied
directly to the higher-order operator. \gsnote{Revisit statement.}
For nonconforming meshes, constructing the low order operator can be
technical at edges and faces of different size; while the basis
functions for the high order operators can be made continuous through
the use of proper algebraic constraints at nonconforming faces, the
corresponding low order discretization has discontinuities at
nonconforming faces.  The construction of a low-order preconditioner
based on the nodes of the high order discretization is a popular
approach \cite{Brown10,Kim07,DevilleMund?}.

\subsection{Schwarz-based methods}
Another common approach for solving systems arising from higher-order
discretizations is based on local block solves.  The main challenge
with these approaches is that they require solving dense local blocks
either using direct methods or approximations that allow for fast
iterative solution \cite{LottesFischer05,FischerLottes05}.
Additionally, the coarse-grid solve can become fairly expensive and is
not straightforward to achieve good parallel scalability.


\section{Smoothers}
% Chebyshef, Jacobi, SSOR



\section{Performance Model}

talk about a performance model, so we can analyse the various approaches.

\section{Evaluation}

Present results here and analyze based on performance model.

\input{results.tex}

\section{Conclusions}

Finalize and discuss ramifications.


\bibliographystyle{wileyj}
\bibliography{mg,ccgo}


\end{document}
